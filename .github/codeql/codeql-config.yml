name: "CodeQL config"

# Use security-extended query suite
queries:
  - uses: security-extended

# Exclude test files from analysis
# Test assertions that verify security features can trigger false positives
# (e.g., checking that javascript: URLs are blocked, checking domain validation)
paths-ignore:
  - "src/__tests__/**"
  - "tests/**"
  - "**/*.test.ts"
  - "**/*.test.tsx"
  - "**/*.spec.ts"
  - "**/*.spec.tsx"
  # regexSafety.ts IS the mitigation layer â€” its functions apply caller-provided
  # regex patterns to length-validated input. All callers use compile-time-constant
  # patterns, not user-provided regex. CodeQL cannot verify this statically.
  - "src/utils/regexSafety.ts"
  # Example apps are demo code, not production. The extraction-only mode
  # (returning citations without verification when no attachmentId is provided)
  # is an intentional design decision, not a security bypass.
  - "examples/**"
